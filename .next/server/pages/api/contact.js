"use strict";(()=>{var e={};e.id=91,e.ids=[91],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},120:(e,r,t)=>{t.r(r),t.d(r,{config:()=>A,default:()=>f,routeModule:()=>h});var n={};t.r(n),t.d(n,{config:()=>g,default:()=>P});var a=t(1802),o=t(7153),s=t(6249);let i=require("@supabase/supabase-js"),c="https://ymrtlcyafzuotngltgcb.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InltcnRsY3lhZnp1b3RuZ2x0Z2NiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTczMjU4MjAsImV4cCI6MjA3MjkwMTgyMH0.-BgOxU6DJe8wF0N_tbBeNpVmHtvfv0BG6YcuzPLK1Gc";if(!c||!l)throw Error("Missing Supabase environment variables");let u=(0,i.createClient)(c,l),d={admin:process.env.REACT_APP_ADMIN_EMAIL||"cooper@dronecareerpro.au",contact:process.env.REACT_APP_CONTACT_EMAIL||"cooper@dronecareerpro.au"},p=async(e,r)=>{let t;let n=`${process.env.REACT_APP_SUPABASE_URL}/functions/v1/resend-email`;"contact"===e&&(t={from:"onboarding@dronecareerpro.com",to:d.admin,subject:`New Contact Form Submission from ${r.name}`,html:`
        <h2>New Contact Form Submission</h2>
        <p><strong>Name:</strong> ${r.name}</p>
        <p><strong>Email:</strong> ${r.email}</p>
        <p><strong>Phone:</strong> ${r.phone}</p>
        <p><strong>Inquiry Type:</strong> ${r.inquiry_type||"Not specified"}</p>
        <p><strong>Message:</strong></p>
        <p>${r.message}</p>
        <hr>
        <p>Received at: ${new Date().toLocaleString()}</p>
      `});let a=await fetch(n,{method:"POST",headers:{Authorization:`Bearer ${process.env.REACT_APP_SUPABASE_ANON_KEY}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok){let e=await a.text();throw console.error("Email function error:",e),Error(e)}return await a.json()},m=async e=>{try{return await p("contact",e)}catch(e){throw console.error("Failed to send contact email:",e),e}};async function P(e,r){if("POST"!==e.method)return r.status(405).json({error:"Method not allowed",message:"This endpoint only accepts POST requests"});try{let{name:t,email:n,phone:a,message:o,inquiryType:s}=e.body;if(!t||!n||!a||!o)return r.status(400).json({error:"Validation Error",message:"Please fill in all required fields (Name, Email, Phone, Message)."});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n))return r.status(400).json({error:"Invalid Email",message:"Please enter a valid email address."});if(!/^[\d\s\-\+\(\)]+$/.test(a))return r.status(400).json({error:"Invalid Phone",message:"Please enter a valid phone number."});let{data:i,error:c}=await u.from("contacts").insert([{name:t,email:n,phone:a,message:o,inquiry_type:s||"general",created_at:new Date().toISOString()}]).select().single();if(c)return console.error("Database error:",c),r.status(500).json({error:"Database Error",message:"Failed to save contact information. Please try again."});try{await m({name:t,email:n,phone:a,message:o,inquiryType:s})}catch(e){console.error("Email sending failed:",e)}return r.status(200).json({success:!0,message:"Thank you for contacting us! We'll get back to you soon.",data:{id:i.id,name:i.name}})}catch(e){return console.error("Contact form submission error:",e),r.status(500).json({error:"Server Error",message:"An unexpected error occurred. Please try again later."})}}let g={api:{bodyParser:{sizeLimit:"1mb"}}},f=(0,s.l)(n,"default"),A=(0,s.l)(n,"config"),h=new a.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/contact",pathname:"/api/contact",bundlePath:"",filename:""},userland:n})},7153:(e,r)=>{var t;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},1802:(e,r,t)=>{e.exports=t(145)}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=r(r.s=120);module.exports=t})();